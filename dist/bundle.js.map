{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://fiber/./src/react/Component/index.js","webpack://fiber/./src/react/CreateElement/index.js","webpack://fiber/./src/react/DOM/createDOMElement.js","webpack://fiber/./src/react/DOM/index.js","webpack://fiber/./src/react/DOM/updateNodeElement.js","webpack://fiber/./src/react/Misc/Arrayed/index.js","webpack://fiber/./src/react/Misc/CreateReactInstance/index.js","webpack://fiber/./src/react/Misc/CreateStateNode/index.js","webpack://fiber/./src/react/Misc/CreateTaskQueue/index.js","webpack://fiber/./src/react/Misc/GetTag/index.js","webpack://fiber/./src/react/Misc/index.js","webpack://fiber/./src/react/index.js","webpack://fiber/./src/react/reconciliation/index.js","webpack://fiber/webpack/bootstrap","webpack://fiber/webpack/runtime/define property getters","webpack://fiber/webpack/runtime/hasOwnProperty shorthand","webpack://fiber/webpack/runtime/make namespace object","webpack://fiber/./src/index.js"],"sourcesContent":["export default class Component {\n    constructor(props) {\n        this.props = props\n    }\n}\n","export default function createElement(type, props, ...children) {\n    const childElements = [].concat(...children).reduce((result, child) => {\n        // true false null 这些值在 react 中是不会渲染到 html 的\n        if (child !== true && child !== false && child !== null) {\n            if (child instanceof Object) {\n                // 如果是一个对象， 则说明原来是一个 <span>aaa</span> 结构，babel已经转换为 vDOM了\n                result.push(child)\n            } else {\n                // 如果是一个文本，需要转换为 vDOM 的结构\n                result.push(createElement('text', {textContent: child}))\n            }\n        }\n        return result\n    }, [])\n    return {\n        type,\n        // 将父级元素传递过来的 children 合并到 props 上\n        props: Object.assign({children: childElements}, props),\n        // children: childElements\n    }\n}\n","import updateNodeElement from \"./updateNodeElement\";\n\nexport default function createDOMElement(virtualDOM){\n    let newElement = null\n    if (virtualDOM.type === 'text') {\n        // 文本节点，调用 createTextElement\n        newElement = document.createTextNode(virtualDOM.props.textContent)\n    } else {\n        // 元素节点，调用 createElement\n        newElement = document.createElement(virtualDOM.type)\n        updateNodeElement(newElement, virtualDOM)\n    }\n\n    return newElement\n}\n","export {default as createDOMElement} from './createDOMElement'\nexport {default as updateNodeElement} from './updateNodeElement'\n","export default function updateNodeElement(newElement, virtualDOM, oldVirtualDOM = {}) {\n    const newProps = virtualDOM.props || {};\n    const oldProps = oldVirtualDOM.props || {};\n    Object.keys(newProps).forEach(propName => {\n        // 获取存储在 props 中的属性值\n        const newPropsValue = newProps[propName]\n        const oldPropsValue = oldProps[propName]\n\n        if (newPropsValue !== oldPropsValue) {\n            // 判断是否是事件属性 onClick => click\n            if (propName.slice(0, 2) === 'on') {\n                // 拿到 事件名称 'click'\n                const eventName = propName.toLowerCase().slice(2);\n                // 给元素添加事件监听\n                newElement.addEventListener(eventName, newPropsValue)\n                // addEventListener 可以添加多个监听\n                // 在此处如果更新元素的事件，要移除之前的事件处理函数\n                if (oldPropsValue) {\n                    newElement.removeEventListener(eventName, oldPropsValue)\n                }\n            } else if (propName === 'value' || propName === 'checked') {\n                // 如果属性名称是表单相关的 value 或这 checked\n                // 通过 ele.value = xx 的方式设置\n                newElement[propName] = newPropsValue\n            } else if (propName !== 'children') {\n                /**\n                 * children 也在 props 属性中，children 会在上一层做处理，\n                 * 这里只对某个 native 元素做处理，添加事件、属性等\n                 */\n\n                // 如果属性名是 className 则给元素设置 class\n                if (propName === 'className') {\n                    newElement.setAttribute('class', newPropsValue)\n                } else {\n                    // 其他熟悉则通过 setAttribute 直接设置\n                    newElement.setAttribute(propName, newPropsValue)\n                }\n            }\n        }\n    })\n\n    /**\n     * 如何判断属性被删除？\n     * 这里有两个 virtualDOM，一个新的一个旧的\n     * 被删除的属性，在 newProps 中没有，oldProps 中存在\n     * 因此，两相对比可以直到某个属性是否被删除\n     * - 如果被删除的属性是事件， removeEventListener 移除之\n     * - 如果被删除的属性是'属性'，removeAttribute 移除之\n     */\n    // 处理属性被删除的情况\n    Object.keys(oldProps).forEach(propName => {\n        const newPropsValue = newProps[propName]\n        const oldPropsValue = oldProps[propName]\n        if (!newPropsValue) {\n            // 属性被删除了\n            if (propName.slice(0, 2) === 'on') {\n                // 如果是事件，移除对应的事件监听\n                const eventName = propName.toLowerCase().slice(2)\n                newElement.removeEventListener(eventName, oldPropsValue)\n            } else if (propName !== 'children') {\n                // 这里一样要排除 children 的情况\n                newElement.removeAttribute(propName)\n            }\n        }\n    })\n}\n","export default arg => Array.isArray(arg) ? arg : [arg];\n","const createReactInstance = fiber => {\n    let instance = null\n    if (fiber.tag === 'class_component') {\n        instance = new fiber.type(fiber.props)\n    } else {\n        instance = fiber.type\n    }\n    return instance\n}\n\nexport default createReactInstance\n","import { createDOMElement } from '../../DOM'\nimport {createReactInstance} from \"../index\";\n\nconst createStateNode = (fiber) => {\n    if(fiber.tag === 'host_component'){\n        return createDOMElement(fiber)\n    } else {\n        return createReactInstance(fiber)\n    }\n}\n\nexport default createStateNode\n","const createTaskQueue = () => {\n    const taskQueue = []\n    return {\n        push: item => taskQueue.push(item),\n        pop: () => taskQueue.shift(),\n        isEmpty: () => taskQueue.length === 0\n    }\n}\n\nexport default createTaskQueue\n","import Component from \"../../Component\";\nconst getTag = (vdom) => {\n    if (typeof vdom.type === 'string'){\n        return 'host_component'\n    } else if (Object.getPrototypeOf(vdom.type) === Component) {\n        return 'class_component'\n    } else {\n        return 'function_component'\n    }\n}\n\nexport default getTag\n","export {default as createTaskQueue} from './CreateTaskQueue'\nexport {default as arrayed} from './Arrayed'\nexport {default as createStateNode} from './CreateStateNode'\nexport {default as getTag} from './GetTag'\nexport {default as createReactInstance} from './CreateReactInstance'\n","import createElement from \"./CreateElement\";\nimport {render} from \"./reconciliation\";\nimport Component from \"./Component\";\n\nexport default {\n    createElement,\n    render,\n    Component\n}\n","import {arrayed, createStateNode, createTaskQueue, getTag} from \"../Misc\";\n\n/**\n * 阶段一的任务：为每一个节点构建 fiber 对象\n * 阶段二的任务：将所有的 fiber 对象构建完成之后加入最外层fiber的effects数组中\n */\nconst taskQueue = createTaskQueue()\n\nlet subTask = null\nlet pendingCommit = null\n\nconst commitAllWork = fiber => {\n    fiber.effects.forEach(child => {\n        if (child.effectTag === 'placement') {\n            let fiber = child\n            let parentFiber = child.parent\n            /**\n             * 如果当前child 是类组件的最外层节点，假设是A\n             * 它不能被挂载到 <A/> 上，应该被挂载到 A 的父级 html 标签(host_component)\n             * 如果多个组件嵌套，那就一直往上找\n             */\n            while (parentFiber.tag === 'class_component' || parentFiber.tag === 'function_component') {\n                parentFiber = parentFiber.parent\n            }\n            if (fiber.tag === 'host_component') {\n                parentFiber.stateNode.appendChild(child.stateNode)\n            }\n        }\n    })\n}\n\n\nconst getFirstTask = () => {\n    // 获取任务\n    const task = taskQueue.pop()\n    // 返回最外层节点的 fiber 对象\n    return {\n        props: task.props,\n        stateNode: task.dom,\n        tag: 'host_root',\n        effects: [],\n        child: null\n    }\n}\n\n/**\n * fiber 子节点的构建原则\n * - 抵达左侧的叶子节点\n * - 首先判断这个节点有没有同级，有则构建同级，无则退回父级， 重复此步骤，直到回到根节点\n *\n */\n\nconst reconcileChildren = (fiber, children) => {\n    /**\n     * children 可能是对象或者数组\n     * 如果是对象，放入数组中返回\n     */\n    const arrayedChildren = arrayed(children)\n\n    let index = 0\n    let numberOfElements = arrayedChildren.length\n    let element = null\n    let newFiber = null\n    let prevFiber = null\n\n    while (index < numberOfElements) {\n        element = arrayedChildren[index]\n        newFiber = {\n            type: element.type,\n            props: element.props,\n            tag: getTag(element),\n            effects: [],\n            effectTag: 'placement',\n            stateNode: null,\n            parent: fiber\n        }\n        newFiber.stateNode = createStateNode(newFiber)\n        // 在 fiber 中，只有第一个是父级的子节点，其他的子节点都应该是第一个子节点的兄弟节点\n        if (index === 0) {\n            fiber.child = newFiber\n        } else {\n            prevFiber.sibling = newFiber\n        }\n\n        prevFiber = newFiber\n        index++\n    }\n}\n\nconst executeTask = fiber => {\n    /**\n     * 构建子级 fiber 对象\n     */\n    if (fiber.tag === 'class_component') {\n        reconcileChildren(fiber, fiber.stateNode.render())\n    } else if (fiber.tag === 'function_component') {\n        reconcileChildren(fiber, fiber.stateNode(fiber.props))\n    } else {\n        reconcileChildren(fiber, fiber.props.children)\n    }\n\n\n    /**\n     * 如果子级存在，返回子级\n     * 将这个子级当作父级，构建这个父级下的子级\n     */\n    if (fiber.child) {\n        return fiber.child\n    }\n\n    let currentExecutingFiber = fiber\n    while (currentExecutingFiber.parent) {\n        /**\n         * 从左侧的最后一个父节点开始\n         * 把所有子节点的 fiber 对对象收集到这个父节点的 effects 数组中\n         * 直到退回根节点，这个根节点的 effects 数组中会有所有的 fiber\n         */\n        currentExecutingFiber.parent.effects = currentExecutingFiber.parent.effects.concat(\n            currentExecutingFiber.effects.concat([currentExecutingFiber])\n        )\n        /**\n         * 没有子节点则判断有无同级\n         * 有同级则返回同级\n         */\n        if (currentExecutingFiber.sibling) {\n            return currentExecutingFiber.sibling\n        }\n        // 没有同级之后回退到当前节点的父节点\n        currentExecutingFiber = currentExecutingFiber.parent\n    }\n\n    pendingCommit = currentExecutingFiber;\n    console.log(currentExecutingFiber);\n}\n\n\nconst workLoop = (deadline) => {\n    /**\n     * 任务不存在，则去队列中获取\n     */\n    if (!subTask) {\n        subTask = getFirstTask()\n    }\n\n    /**\n     * 有任务其浏览器有空闲时间\n     * 调用 executeTask 执行\n     */\n    while (subTask && deadline.timeRemaining() > 1) {\n        subTask = executeTask(subTask)\n    }\n\n    if (pendingCommit) {\n        commitAllWork(pendingCommit)\n    }\n}\n\n\nconst performTask = (deadline) => {\n    // 执行任务\n    workLoop(deadline)\n    // 判断任务是否存在，队列里面是否还有未执行任务\n    // 如果有则让浏览器继续在空闲事件执行\n    if (subTask || !taskQueue.isEmpty()) {\n        requestIdleCallback(performTask)\n    }\n}\n\nexport const render = (element, dom) => {\n    /**\n     * 1、向任务队列中添加任务\n     * 2、指定在浏览器空闲的时候执行\n     *\n     * 任务：通过 vdom 构建 fiber 对象\n     */\n\n    taskQueue.push({\n        dom,\n        props: {children: element}\n    })\n\n    requestIdleCallback(performTask)\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import React from './react'\nimport {render} from \"./react/reconciliation\";\nimport Component from \"./react/Component\";\n\nconst root = document.getElementById('root')\n\nconst jsx = (\n    <div>\n        <p>Hello React Fiber</p>\n        <div>\n            <p>Fiber</p>\n            <span style=\"color: red\">&hearts;</span>\n        </div>\n    </div>\n)\n// render(jsx, root)\n\n\nclass Greeting extends Component{\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n        return (\n            <div>\n                {this.props.title}\n            </div>\n        );\n    }\n}\n\nrender(<Greeting title=\"奥力给\"/>, root)\n\n\nfunction FunctionComponent (props){\n    return <div>{props.title}, FunctionComponent</div>\n}\n\n\n// render(<FunctionComponent title=\"Hello\"/>, root)\n\n"],"names":["Component","props","createElement","type","children","childElements","concat","reduce","result","child","Object","push","textContent","assign","updateNodeElement","createDOMElement","virtualDOM","newElement","document","createTextNode","default","oldVirtualDOM","newProps","oldProps","keys","forEach","propName","newPropsValue","oldPropsValue","slice","eventName","toLowerCase","addEventListener","removeEventListener","setAttribute","removeAttribute","arg","Array","isArray","createReactInstance","fiber","instance","tag","createStateNode","createTaskQueue","taskQueue","item","pop","shift","isEmpty","length","getTag","vdom","getPrototypeOf","arrayed","render","subTask","pendingCommit","commitAllWork","effects","effectTag","parentFiber","parent","stateNode","appendChild","getFirstTask","task","dom","reconcileChildren","arrayedChildren","index","numberOfElements","element","newFiber","prevFiber","sibling","executeTask","currentExecutingFiber","console","log","workLoop","deadline","timeRemaining","performTask","requestIdleCallback","React","root","getElementById","jsx","Greeting","title","FunctionComponent"],"sourceRoot":""}